import sys, os; sys.path.insert(0, os.path.join(os.path.dirname(__file__), '..'))
from calc import calc1, calc2, calc3, calc4, calc5, calc6, calc7
from test_helper import test

if __name__ == '__main__':
    # calc1: add and subtract
    test("1+2+3", "6", calc1)
    test("123+456 - 789", "-210", calc1)
    test("123-456", "-333", calc1)

    # calc2: add multiply and divide
    test("1+2+3", "6", calc2)
    test("123+456 - 789", "-210", calc2)
    test("123-456", "-333", calc2)
    test("1*2*3", "6", calc2)
    test("123+456*789", "359907", calc2)
    test("1+2*3-4", "3", calc2)
    test("1+2*3-5/4", "23/4", calc2)
    test("1*2*3*4*5/6", "20", calc2)

    # calc3: recursive descent parser with parentheses and exponents
    test("1+2+3", "6", calc3)
    test("123+456 - 789", "-210", calc3)
    test("123-456", "-333", calc3)
    test("1*2*3", "6", calc3)
    test("123+456*789", "359907", calc3)
    test("1+2*3-4", "3", calc3)
    test("1+2*3-5/4", "23/4", calc3)
    test("1*2*3*4*5/6", "20", calc3)
    test("1+2*(3-4)", "-1", calc3)
    test("(3^5+2)/(7*7)", "5", calc3)
    test("1**2", "", calc3, Exception())
    test("", "", calc3, Exception())

    # calc4: scientific notation and decimals
    test("1+2+3", "6", calc4)
    test("1+2*3-4", "3", calc4)
    test("1e2", "100", calc4)
    test("1.5e3", "1500", calc4)
    test("2.5e-3", "0.0025", calc4)
    test("1.5E+3", "1500", calc4)
    test("1e2+1.5e2", "250", calc4)
    test("1.5e3*2", "3000", calc4)
    test("(1e2+1.5e2)*2e1", "5000", calc4)
    test("1.5e3/1.5e2", "10", calc4)
    test("", "", calc4, Exception())

    # calc5: named constants (pi, e)
    test("pi", "3.141592653589793", calc5)
    test("e", "2.718281828459045", calc5)
    test("2*pi", "6.283185307179586", calc5)
    test("pi+e", "5.859874482048838", calc5)
    test("e^2", "7.3890560989306495", calc5)
    test("1e2*pi", "314.1592653589793", calc5)
    test("1+2", "3", calc5)
    test("foo", "", calc5, Exception())

    # calc6: imaginary unit and complex numbers
    test("i", "i", calc6)
    test("i*i", "-1", calc6)
    test("i^2", "-1", calc6)
    test("1+i", "1+i", calc6)
    test("1-i", "1-i", calc6)
    test("(1+i)*2", "2+2i", calc6)
    test("(1+i)*(1-i)", "2", calc6)
    test("(1+i)/(1-i)", "i", calc6)
    test("2+3*i", "2+3i", calc6)
    test("e^(i*pi)", "-1", calc6)
    test("1+2", "3", calc6)

    # calc7: math functions (sin, cos, tan, exp, ln, log, sqrt, abs, etc.)
    test("sin(0)", "0", calc7)
    test("cos(0)", "1", calc7)
    test("sin(pi/2)", "1", calc7)
    test("tan(pi/4)", "1", calc7)
    test("sinh(0)", "0", calc7)
    test("cosh(0)", "1", calc7)
    test("exp(1)", "2.718281828459045", calc7)
    test("ln(1)", "0", calc7)
    test("log(100)", "2", calc7)
    test("sqrt(4)", "2", calc7)
    test("sqrt(0-1)", "i", calc7)
    test("abs(3+4*i)", "5", calc7)
    test("e^(i*pi)", "-1", calc7)
    test("1+2", "3", calc7)
